{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://copilot-atlas.local/schemas/oracle.research-findings.schema.json",
  "title": "OracleResearchFindings",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "agent",
    "status",
    "confidence",
    "abstain",
    "scope_in",
    "scope_out",
    "relevant_files",
    "key_findings",
    "patterns",
    "implementation_options",
    "open_questions"
  ],
  "properties": {
    "schema_version": { "type": "string", "const": "1.0.0" },
    "agent": { "type": "string", "const": "Oracle-subagent" },
    "status": {
      "type": "string",
      "enum": ["COMPLETE", "ABSTAIN", "INSUFFICIENT_EVIDENCE"]
    },
    "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
    "abstain": {
      "type": "object",
      "additionalProperties": false,
      "required": ["is_abstaining", "reasons"],
      "properties": {
        "is_abstaining": { "type": "boolean" },
        "reasons": { "type": "array", "items": { "type": "string" } }
      }
    },
    "scope_in": { "type": "array", "items": { "type": "string" }, "minItems": 1 },
    "scope_out": { "type": "array", "items": { "type": "string" }, "minItems": 1 },
    "relevant_files": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["path", "purpose"],
        "properties": {
          "path": { "type": "string" },
          "purpose": { "type": "string" },
          "symbols": { "type": "array", "items": { "type": "string" } }
        }
      }
    },
    "key_findings": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["fact", "evidence"],
        "properties": {
          "fact": { "type": "string" },
          "evidence": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["file", "line_start"],
              "properties": {
                "file": { "type": "string" },
                "line_start": { "type": "integer", "minimum": 1 },
                "line_end": { "type": "integer", "minimum": 1 }
              }
            }
          }
        }
      }
    },
    "patterns": { "type": "array", "items": { "type": "string" } },
    "implementation_options": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["option", "tradeoffs", "based_on"],
        "properties": {
          "option": { "type": "string" },
          "tradeoffs": { "type": "array", "items": { "type": "string" } },
          "based_on": { "type": "array", "items": { "type": "string" } }
        }
      }
    },
    "open_questions": { "type": "array", "items": { "type": "string" } }
  }
}