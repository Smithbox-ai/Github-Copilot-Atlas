{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://copilot-atlas.local/schemas/sisyphus.execution-report.schema.json",
  "title": "SisyphusExecutionReport",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "agent",
    "status",
    "confidence",
    "abstain",
    "scope",
    "changes",
    "tests",
    "build",
    "lint",
    "dependencies",
    "definition_of_done",
    "next_steps"
  ],
  "properties": {
    "schema_version": { "type": "string", "const": "1.0.0" },
    "agent": { "type": "string", "const": "Sisyphus-subagent" },
    "status": { "type": "string", "enum": ["COMPLETE", "NEEDS_INPUT", "FAILED", "ABSTAIN"] },
    "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
    "abstain": {
      "type": "object",
      "additionalProperties": false,
      "required": ["is_abstaining", "reasons"],
      "properties": {
        "is_abstaining": { "type": "boolean" },
        "reasons": { "type": "array", "items": { "type": "string" } }
      }
    },
    "scope": {
      "type": "object",
      "additionalProperties": false,
      "required": ["in_scope", "out_of_scope"],
      "properties": {
        "in_scope": { "type": "array", "items": { "type": "string" } },
        "out_of_scope": { "type": "array", "items": { "type": "string" } }
      }
    },
    "changes": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["file", "action", "summary"],
        "properties": {
          "file": { "type": "string" },
          "action": { "type": "string", "enum": ["create", "modify", "delete"] },
          "summary": { "type": "string" }
        }
      }
    },
    "tests": {
      "type": "object",
      "additionalProperties": false,
      "required": ["individual", "full_suite"],
      "properties": {
        "individual": { "type": "string", "enum": ["PASS", "FAIL", "NOT_RUN"] },
        "full_suite": { "type": "string", "enum": ["PASS", "FAIL", "NOT_RUN"] },
        "details": { "type": "string" }
      }
    },
    "build": {
      "type": "object",
      "additionalProperties": false,
      "required": ["state"],
      "properties": {
        "state": { "type": "string", "enum": ["PASS", "FAIL", "NOT_AVAILABLE", "NOT_RUN"] },
        "details": { "type": "string" }
      }
    },
    "lint": {
      "type": "object",
      "additionalProperties": false,
      "required": ["state"],
      "properties": {
        "state": { "type": "string", "enum": ["PASS", "FAIL", "NOT_AVAILABLE", "NOT_RUN"] },
        "details": { "type": "string" }
      }
    },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["name", "reason"],
        "properties": {
          "name": { "type": "string" },
          "reason": { "type": "string" }
        }
      }
    },
    "definition_of_done": {
      "type": "object",
      "additionalProperties": false,
      "required": ["all_items_complete", "unchecked_items"],
      "properties": {
        "all_items_complete": { "type": "boolean" },
        "unchecked_items": { "type": "array", "items": { "type": "string" } }
      }
    },
    "next_steps": { "type": "array", "items": { "type": "string" } }
  }
}